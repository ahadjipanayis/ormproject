{% load static %}

<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        body { font-family: Calibri, sans-serif; font-size: 14px; line-height: 1.6; color: #333; }
        h3 { color: #003366; margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { padding: 8px 12px; border: 1px solid #ccc; text-align: left; }
        th { background-color: #f2f2f2; }
        details { margin-bottom: 20px; }
        summary { font-size: 16px; font-weight: bold; cursor: pointer; color: #003366; }
        ol { padding-left: 20px; }
        a { color: #003366; text-decoration: none; }
        a:hover { text-decoration: underline; }
        .signature { margin-top: 40px; }
    </style>
</head>
<body>
    <p>Î‘Î³Î±Ï€Î·Ï„Î­/Î® ÎšÏÏÎ¹Îµ/ÎšÏ…ÏÎ¯Î± {{ user }},</p>

    <p>Î‘ÎºÎ¿Î»Î¿Ï…Î¸ÎµÎ¯ Î· Î±Î½Î±Î»Ï…Ï„Î¹ÎºÎ® Î±Î½Î±Ï†Î¿ÏÎ¬ Ï„Ï‰Î½ ÎµÏÎ³Î±ÏƒÎ¹ÏÎ½ ÏƒÎ±Ï‚ Î±Ï€ÏŒ Ï„Î·Î½ Ï€Î»Î±Ï„Ï†ÏŒÏÎ¼Î± <strong>ermapp.avax.gr</strong>.</p>
    <h3>Î£Ï…Î½Î¿Ï€Ï„Î¹ÎºÏŒÏ‚ Î Î¯Î½Î±ÎºÎ±Ï‚</h3>
    <table>
        <thead>
            <tr>
                <th>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</th>
                <th>Î£ÏÎ½Î¿Î»Î¿</th>
                <th>Î•Î½Ï„ÏŒÏ‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±Ï‚</th>
                <th>Î•ÎºÏ„ÏŒÏ‚ Ï€ÏÎ¿Î¸ÎµÏƒÎ¼Î¯Î±Ï‚</th>

            </tr>
        </thead>
        <tbody>
            <tr>
                <td><strong>Î•Î³ÎºÏÎ¯ÏƒÎµÎ¹Ï‚</strong></td>
                <td>{{ totals.approvals.total }}</td>
                <td style="color: green;">{{ totals.approvals.future }}</td>
                <td style="color: red;">{{ totals.approvals.overdue }}</td>

            </tr>
         
            <tr>
                <td><strong>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·</strong></td>
                <td>{{ totals.owner.total }}</td>
                <td style="color: green;">{{ totals.owner.future }}</td>
                <td style="color: red;">{{ totals.owner.overdue }}</td>

            </tr>

            <tr>
                <td><strong>Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Î•ÎºÏ„ÎµÎ»ÎµÏƒÏ„Î®</strong></td>
                <td>{{ totals.performer.total }}</td>
                <td style="color: green;">{{ totals.performer.future }}</td>
                <td style="color: red;">{{ totals.performer.overdue }}</td>

            </tr>
        </tbody>
    </table>

    {% if totals.approvals.total == 0 and totals.performer.total == 0 and totals.owner.total == 0 %}
        <p style="color: green; font-weight: bold;">ğŸ‰ Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ ÎµÎºÎºÏÎµÎ¼ÎµÎ¯Ï‚ ÎµÎ½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Î® Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ Î­Î³ÎºÏÎ¹ÏƒÎ·Ï‚ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®!</p>
    {% endif %}

    <p>Î Î±ÏÎ±ÎºÎ¬Ï„Ï‰ Ï€Î±ÏÎ±Ï„Î¯Î¸ÎµÎ½Ï„Î±Î¹ Î¿Î¹ ÎµÏÎ³Î±ÏƒÎ¯ÎµÏ‚ Ï€Î¿Ï… Î±Ï€Î±Î¹Ï„Î¿ÏÎ½ Ï„Î·Î½ Ï€ÏÎ¿ÏƒÎ¿Ï‡Î® ÏƒÎ±Ï‚:</p>

    {% if approval_links %}
    <details open>
        <summary> âœ… Î•Î³ÎºÏÎ¯ÏƒÎµÎ¹Ï‚ ({{ approval_links|length }})</summary>
        <ol>
            {% for approval in approval_links %}
                <li>
                    <a href="{{ approval.url }}">{{ approval.risk_title | safe }}</a>
                    {% if approval.days_until_due is not None %}
                        {% if approval.days_until_due < 0 %}
                            <span style="color: red;">ğŸ”´ Î›Î·Î³Î¼Î­Î½Î¿ ({{ approval.due_date|date:"Y-m-d" }})</span>
                        {% elif approval.days_until_due == 0 %}
                            <span style="color: orange;">ğŸŸ  Î›Î®Î³ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ±</span>
                        {% else %}
                            <span style="color: green;">ğŸŸ¢ Î£Îµ {{ approval.days_until_due }} Î·Î¼Î­ÏÎµÏ‚</span>
                        {% endif %}
                    {% endif %}
                </li>
            {% endfor %}
        </ol>
    </details>
    {% endif %}

    {% if action_performer_links %}
    <details open>
        <summary> ğŸ“‹ Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Ï‰Ï‚ Î•ÎºÏ„ÎµÎ»ÎµÏƒÏ„Î®Ï‚ ({{ action_performer_links|length }})</summary>
        <ol>
            {% for action in action_performer_links %}
                <li>
                    <a href="{{ action.url }}">{{ action.title | safe}}</a>
                    {% if action.days_until_deadline is not None %}
                        {% if action.days_until_deadline < 0 %}
                            <span style="color: red;">ğŸ”´ Î›Î·Î³Î¼Î­Î½Î· ({{ action.deadline|date:"Y-m-d" }})</span>
                        {% elif action.days_until_deadline == 0 %}
                            <span style="color: orange;">ğŸŸ  Î›Î®Î³ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ±</span>
                        {% else %}
                            <span style="color: green;">ğŸŸ¢ Î£Îµ {{ action.days_until_deadline }} Î·Î¼Î­ÏÎµÏ‚</span>
                        {% endif %}
                    {% endif %}
                </li>
            {% endfor %}
        </ol>
    </details>
    {% endif %}

    {% if action_owner_links %}
    <details open>
        <summary> ğŸ“‹ Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ Ï‰Ï‚ Î™Î´Î¹Î¿ÎºÏ„Î®Ï„Î·Ï‚ ({{ action_owner_links|length }})</summary>
        <ol>
            {% for action in action_owner_links %}
                <li>
                    <a href="{{ action.url }}">{{ action.title | safe }}</a>
                    {% if action.days_until_deadline is not None %}
                        {% if action.days_until_deadline < 0 %}
                            <span style="color: red;">ğŸ”´ Î›Î·Î³Î¼Î­Î½Î· ({{ action.deadline|date:"Y-m-d" }})</span>
                        {% elif action.days_until_deadline == 0 %}
                            <span style="color: orange;">ğŸŸ  Î›Î®Î³ÎµÎ¹ ÏƒÎ®Î¼ÎµÏÎ±</span>
                        {% else %}
                            <span style="color: green;">ğŸŸ¢ Î£Îµ {{ action.days_until_deadline }} Î·Î¼Î­ÏÎµÏ‚</span>
                        {% endif %}
                    {% endif %}
                </li>
            {% endfor %}
        </ol>
    </details>
    {% endif %}

    <div class="signature">
        <p>ÎœÎµ ÎµÎºÏ„Î¯Î¼Î·ÏƒÎ·,<br><strong>ermapp.avax.gr</strong> (Î”Î¹Î±Ï‡ÎµÎ¹ÏÎ¹ÏƒÏ„Î®Ï‚)</p>
        <img src="{% static 'images/email_signature.png' %}" alt="Email Signature" style="max-width: 100%; height: auto;">
    </div>

</body>
</html>